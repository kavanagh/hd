(function(t){function e(r){function a(t){return t&&"object"==typeof t&&!Cr(t)&&nr.call(t,"__wrapped__")?t:new J(t)}function L(t){var e=t.length,n=e>=l;if(n)for(var r={},i=-1;e>++i;){var a=u+t[i];(r[a]||(r[a]=[])).push(t[i])}return function(e){if(n){var i=u+e;return r[i]&&We(r[i],e)>-1}return We(t,e)>-1}}function U(t){return t.charCodeAt(0)}function q(t,e){var r=t.index,i=e.index;if(t=t.criteria,e=e.criteria,t!==e){if(t>e||t===n)return 1;if(e>t||e===n)return-1}return i>r?-1:1}function B(t,e,n,r){function i(){var r=arguments,l=s?this:e;if(a||(t=e[o]),n.length&&(r=r.length?(r=vr.call(r),u?r.concat(n):n.concat(r)):n),this instanceof i){K.prototype=t.prototype,l=new K,K.prototype=null;var c=t.apply(l,r);return he(c)?c:l}return t.apply(l,r)}var a=ce(t),s=!n,o=e;if(s){var u=r;n=e}else if(!a){if(!r)throw new Jn;e=t}return i}function M(){for(var t,e={shadowedProps:k,support:_r,arrays:"isArray(iterable)",bottom:"",init:"iterable",loop:"",top:"",useHas:!0,useKeys:!!Sr},n=0;t=arguments[n];n++)for(var r in t)e[r]=t[r];var i=e.args;e.firstArg=/^[^,]+/.exec(i)[0];var s=qn("hasOwnProperty, isArguments, isArray, isString, keys, lodash, objectTypes","return function("+i+") {\n"+xr(e)+"\n}");return s(nr,G,Cr,ve,Sr,a,H)}function z(t){return"\\"+R[t]}function V(t){return $r[t]}function D(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}function J(t){this.__wrapped__=t}function K(){}function W(t){var e=!1;if(!t||sr.call(t)!=A||!_r.argsClass&&G(t))return e;var n=t.constructor;return(ce(n)?n instanceof n:_r.nodeClass||!D(t))?_r.ownLast?(Ir(t,function(t,n,r){return e=nr.call(r,n),!1}),e===!0):(Ir(t,function(t,n){e=n}),e===!1||nr.call(t,e)):e}function X(t,e,r){e||(e=0),r===n&&(r=t?t.length:0);for(var i=-1,a=r-e||0,s=Fn(0>a?0:a);a>++i;)s[i]=t[e+i];return s}function Q(t){return Tr[t]}function G(t){return sr.call(t)==C}function Y(t,e,r,i,s,o){var u=t;if("function"==typeof e&&(i=r,r=e,e=!1),"function"==typeof r){if(r=i===n?r:a.createCallback(r,i,1),u=r(u),u!==n)return u;u=t}var l=he(u);if(l){var c=sr.call(u);if(!N[c]||!_r.nodeClass&&D(u))return u;var h=Cr(u)}if(!l||!e)return l?h?X(u):Ar({},u):u;var f=br[c];switch(c){case S:case O:return new f(+u);case T:case I:return new f(u);case P:return f(u.source,g.exec(u))}s||(s=[]),o||(o=[]);for(var p=s.length;p--;)if(s[p]==t)return o[p];return u=h?f(u.length):{},h&&(nr.call(t,"index")&&(u.index=t.index),nr.call(t,"input")&&(u.input=t.input)),s.push(t),o.push(u),(h?$e:Nr)(t,function(t,i){u[i]=Y(t,e,r,n,s,o)}),u}function Z(t,e,n){return Y(t,!0,e,n)}function te(t,e,r){var i;return e=a.createCallback(e,r),Nr(t,function(t,r,a){return e(t,r,a)?(i=r,!1):n}),i}function ee(t){var e=[];return Ir(t,function(t,n){ce(t)&&e.push(n)}),e.sort()}function ne(t,e){return t?nr.call(t,e):!1}function re(t){for(var e=-1,n=Sr(t),r=n.length,i={};r>++e;){var a=n[e];i[t[a]]=a}return i}function ie(t){return t===!0||t===!1||sr.call(t)==S}function ae(t){return t?"object"==typeof t&&sr.call(t)==O:!1}function se(t){return t?1===t.nodeType:!1}function oe(t){var e=!0;if(!t)return e;var n=sr.call(t),r=t.length;return n==E||n==I||(_r.argsClass?n==C:G(t))||n==A&&"number"==typeof r&&ce(t.splice)?!r:(Nr(t,function(){return e=!1}),e)}function ue(t,e,r,i,s,u){var l=r===o;if("function"==typeof r&&!l){r=a.createCallback(r,i,2);var c=r(t,e);if(c!==n)return!!c}if(t===e)return 0!==t||1/t==1/e;var h=typeof t,f=typeof e;if(t===t&&(!t||"function"!=h&&"object"!=h)&&(!e||"function"!=f&&"object"!=f))return!1;if(null==t||null==e)return t===e;var p=sr.call(t),d=sr.call(e);if(p==C&&(p=A),d==C&&(d=A),p!=d)return!1;switch(p){case S:case O:return+t==+e;case T:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case P:case I:return t==Dn(e)}var g=p==E;if(!g){if(nr.call(t,"__wrapped__ ")||nr.call(e,"__wrapped__"))return ue(t.__wrapped__||t,e.__wrapped__||e,r,i,s,u);if(p!=A||!_r.nodeClass&&(D(t)||D(e)))return!1;var v=!_r.argsObject&&G(t)?zn:t.constructor,m=!_r.argsObject&&G(e)?zn:e.constructor;if(v!=m&&!(ce(v)&&v instanceof v&&ce(m)&&m instanceof m))return!1}s||(s=[]),u||(u=[]);for(var y=s.length;y--;)if(s[y]==t)return u[y]==e;var b=0;if(c=!0,s.push(t),u.push(e),g){if(y=t.length,b=e.length,c=b==t.length,!c&&!l)return c;for(;b--;){var _=y,x=e[b];if(l)for(;_--&&!(c=ue(t[_],x,r,i,s,u)););else if(!(c=ue(t[b],x,r,i,s,u)))break}return c}return Ir(e,function(e,a,o){return nr.call(o,a)?(b++,c=nr.call(t,a)&&ue(t[a],e,r,i,s,u)):n}),c&&!l&&Ir(t,function(t,e,r){return nr.call(r,e)?c=--b>-1:n}),c}function le(t){return lr(t)&&!cr(parseFloat(t))}function ce(t){return"function"==typeof t}function he(t){return t?H[typeof t]:!1}function fe(t){return de(t)&&t!=+t}function pe(t){return null===t}function de(t){return"number"==typeof t||sr.call(t)==T}function ge(t){return t?H[typeof t]&&sr.call(t)==P:!1}function ve(t){return"string"==typeof t||sr.call(t)==I}function me(t){return t===n}function ye(t,e,r){var i=arguments,s=0,u=2;if(!he(t))return t;if(r===o)var l=i[3],c=i[4],h=i[5];else c=[],h=[],"number"!=typeof r&&(u=i.length),u>3&&"function"==typeof i[u-2]?l=a.createCallback(i[--u-1],i[u--],2):u>2&&"function"==typeof i[u-1]&&(l=i[--u]);for(;u>++s;)(Cr(i[s])?$e:Nr)(i[s],function(e,r){var i,a,s=e,u=t[r];if(e&&((a=Cr(e))||Hr(e))){for(var f=c.length;f--;)if(i=c[f]==e){u=h[f];break}if(!i){var p;l&&(s=l(u,e),(p=s!==n)&&(u=s)),p||(u=a?Cr(u)?u:[]:Hr(u)?u:{}),c.push(e),h.push(u),p||(u=ye(u,e,o,l,c,h))}}else l&&(s=l(u,e),s===n&&(s=e)),s!==n&&(u=s);t[r]=u});return t}function be(t,e,n){var r="function"==typeof e,i={};if(r)e=a.createCallback(e,n);else var s=Zn.apply(Kn,vr.call(arguments,1));return Ir(t,function(t,n,a){(r?!e(t,n,a):0>We(s,n))&&(i[n]=t)}),i}function _e(t){for(var e=-1,n=Sr(t),r=n.length,i=Fn(r);r>++e;){var a=n[e];i[e]=[a,t[a]]}return i}function xe(t,e,n){var r={};if("function"!=typeof e)for(var i=-1,s=Zn.apply(Kn,vr.call(arguments,1)),o=he(t)?s.length:0;o>++i;){var u=s[i];u in t&&(r[u]=t[u])}else e=a.createCallback(e,n),Ir(t,function(t,n,i){e(t,n,i)&&(r[n]=t)});return r}function we(t){for(var e=-1,n=Sr(t),r=n.length,i=Fn(r);r>++e;)i[e]=t[n[e]];return i}function ke(t){var e=-1,n=Zn.apply(Kn,vr.call(arguments,1)),r=n.length,i=Fn(r);for(_r.unindexedChars&&ve(t)&&(t=t.split(""));r>++e;)i[e]=t[n[e]];return i}function je(t,e,r){var i=-1,a=t?t.length:0,s=!1;return r=(0>r?fr(0,a+r):r)||0,"number"==typeof a?s=(ve(t)?t.indexOf(e,r):We(t,e,r))>-1:Or(t,function(t){return++i>=r?!(s=t===e):n}),s}function Ce(t,e,n){var r={};return e=a.createCallback(e,n),$e(t,function(t,n,i){n=Dn(e(t,n,i)),nr.call(r,n)?r[n]++:r[n]=1}),r}function Ee(t,e,n){var r=!0;if(e=a.createCallback(e,n),Cr(t))for(var i=-1,s=t.length;s>++i&&(r=!!e(t[i],i,t)););else Or(t,function(t,n,i){return r=!!e(t,n,i)});return r}function Se(t,e,n){var r=[];if(e=a.createCallback(e,n),Cr(t))for(var i=-1,s=t.length;s>++i;){var o=t[i];e(o,i,t)&&r.push(o)}else Or(t,function(t,n,i){e(t,n,i)&&r.push(t)});return r}function Oe(t,e,r){if(e=a.createCallback(e,r),!Cr(t)){var i;return Or(t,function(t,r,a){return e(t,r,a)?(i=t,!1):n}),i}for(var s=-1,o=t.length;o>++s;){var u=t[s];if(e(u,s,t))return u}}function $e(t,e,r){if(e&&r===n&&Cr(t))for(var i=-1,a=t.length;a>++i&&e(t[i],i,t)!==!1;);else Or(t,e,r);return t}function Te(t,e,n){var r={};return e=a.createCallback(e,n),$e(t,function(t,n,i){n=Dn(e(t,n,i)),(nr.call(r,n)?r[n]:r[n]=[]).push(t)}),r}function Ae(t,e){var n=vr.call(arguments,2),r=-1,i="function"==typeof e,a=t?t.length:0,s=Fn("number"==typeof a?a:0);return $e(t,function(t){s[++r]=(i?e:t[e]).apply(t,n)}),s}function Pe(t,e,n){var r=-1,i=t?t.length:0,s=Fn("number"==typeof i?i:0);if(e=a.createCallback(e,n),Cr(t))for(;i>++r;)s[r]=e(t[r],r,t);else Or(t,function(t,n,i){s[++r]=e(t,n,i)});return s}function Ie(t,e,n){var r=-1/0,i=r;if(!e&&Cr(t))for(var s=-1,o=t.length;o>++s;){var u=t[s];u>i&&(i=u)}else e=!e&&ve(t)?U:a.createCallback(e,n),Or(t,function(t,n,a){var s=e(t,n,a);s>r&&(r=s,i=t)});return i}function Ne(t,e,n){var r=1/0,i=r;if(!e&&Cr(t))for(var s=-1,o=t.length;o>++s;){var u=t[s];i>u&&(i=u)}else e=!e&&ve(t)?U:a.createCallback(e,n),Or(t,function(t,n,a){var s=e(t,n,a);r>s&&(r=s,i=t)});return i}function He(t,e,n,r){var i=3>arguments.length;if(e=a.createCallback(e,r,4),Cr(t)){var s=-1,o=t.length;for(i&&(n=t[++s]);o>++s;)n=e(n,t[s],s,t)}else Or(t,function(t,r,a){n=i?(i=!1,t):e(n,t,r,a)});return n}function Re(t,e,n,r){var i=t,s=t?t.length:0,o=3>arguments.length;if("number"!=typeof s){var u=Sr(t);s=u.length}else _r.unindexedChars&&ve(t)&&(i=t.split(""));return e=a.createCallback(e,r,4),$e(t,function(t,r,a){r=u?u[--s]:--s,n=o?(o=!1,i[r]):e(n,i[r],r,a)}),n}function Fe(t,e,n){return e=a.createCallback(e,n),Se(t,function(t,n,r){return!e(t,n,r)})}function Le(t){var e=-1,n=t?t.length:0,r=Fn("number"==typeof n?n:0);return $e(t,function(t){var n=tr(gr()*(++e+1));r[e]=r[n],r[n]=t}),r}function Ue(t){var e=t?t.length:0;return"number"==typeof e?e:Sr(t).length}function qe(t,e,n){var r;if(e=a.createCallback(e,n),Cr(t))for(var i=-1,s=t.length;s>++i&&!(r=e(t[i],i,t)););else Or(t,function(t,n,i){return!(r=e(t,n,i))});return!!r}function Be(t,e,n){var r=-1,i=t?t.length:0,s=Fn("number"==typeof i?i:0);for(e=a.createCallback(e,n),$e(t,function(t,n,i){s[++r]={criteria:e(t,n,i),index:r,value:t}}),i=s.length,s.sort(q);i--;)s[i]=s[i].value;return s}function Me(t){return t&&"number"==typeof t.length?_r.unindexedChars&&ve(t)?t.split(""):X(t):we(t)}function ze(t){for(var e=-1,n=t?t.length:0,r=[];n>++e;){var i=t[e];i&&r.push(i)}return r}function Ve(t){for(var e=-1,n=t?t.length:0,r=Zn.apply(Kn,vr.call(arguments,1)),i=L(r),a=[];n>++e;){var s=t[e];i(s)||a.push(s)}return a}function De(t,e,n){var r=-1,i=t?t.length:0;for(e=a.createCallback(e,n);i>++r;)if(e(t[r],r,t))return r;return-1}function Je(t,e,n){if(t){var r=0,i=t.length;if("number"!=typeof e&&null!=e){var s=-1;for(e=a.createCallback(e,n);i>++s&&e(t[s],s,t);)r++}else if(r=e,null==r||n)return t[0];return X(t,0,pr(fr(0,r),i))}}function Ke(t,e,n,r){var i=-1,s=t?t.length:0,o=[];for("boolean"!=typeof e&&null!=e&&(r=n,n=e,e=!1),null!=n&&(n=a.createCallback(n,r));s>++i;){var u=t[i];n&&(u=n(u,i,t)),Cr(u)?rr.apply(o,e?u:Ke(u)):o.push(u)}return o}function We(t,e,n){var r=-1,i=t?t.length:0;if("number"==typeof n)r=(0>n?fr(0,i+n):n||0)-1;else if(n)return r=en(t,e),t[r]===e?r:-1;for(;i>++r;)if(t[r]===e)return r;return-1}function Xe(t,e,n){if(!t)return[];var r=0,i=t.length;if("number"!=typeof e&&null!=e){var s=i;for(e=a.createCallback(e,n);s--&&e(t[s],s,t);)r++}else r=null==e||n?1:e||r;return X(t,0,pr(fr(0,i-r),i))}function Qe(t){var e=arguments,n=e.length,r={0:{}},i=-1,a=t?t.length:0,s=a>=l,o=[],c=o;t:for(;a>++i;){var h=t[i];if(s)var f=u+h,p=r[0][f]?!(c=r[0][f]):c=r[0][f]=[];if(p||0>We(c,h)){s&&c.push(h);for(var d=n;--d;)if(!(r[d]||(r[d]=L(e[d])))(h))continue t;o.push(h)}}return o}function Ge(t,e,n){if(t){var r=0,i=t.length;if("number"!=typeof e&&null!=e){var s=i;for(e=a.createCallback(e,n);s--&&e(t[s],s,t);)r++}else if(r=e,null==r||n)return t[i-1];return X(t,fr(0,i-r))}}function Ye(t,e,n){var r=t?t.length:0;for("number"==typeof n&&(r=(0>n?fr(0,r+n):pr(n,r-1))+1);r--;)if(t[r]===e)return r;return-1}function Ze(t,e,n){t=+t||0,n=+n||1,null==e&&(e=t,t=0);for(var r=-1,i=fr(0,Gn((e-t)/n)),a=Fn(i);i>++r;)a[r]=t,t+=n;return a}function tn(t,e,n){if("number"!=typeof e&&null!=e){var r=0,i=-1,s=t?t.length:0;for(e=a.createCallback(e,n);s>++i&&e(t[i],i,t);)r++}else r=null==e||n?1:fr(0,e);return X(t,r)}function en(t,e,n,r){var i=0,s=t?t.length:i;for(n=n?a.createCallback(n,r,1):Cn,e=n(e);s>i;){var o=i+s>>>1;e>n(t[o])?i=o+1:s=o}return i}function nn(t){return Cr(t)||(arguments[0]=t?vr.call(t):Kn),rn(Zn.apply(Kn,arguments))}function rn(t,e,n,r){var i=-1,s=t?t.length:0,o=[],c=o;"boolean"!=typeof e&&null!=e&&(r=n,n=e,e=!1);var h=!e&&s>=l;if(h)var f={};for(null!=n&&(c=[],n=a.createCallback(n,r));s>++i;){var p=t[i],d=n?n(p,i,t):p;if(h)var g=u+d,v=f[g]?!(c=f[g]):c=f[g]=[];(e?!i||c[c.length-1]!==d:v||0>We(c,d))&&((n||h)&&c.push(d),o.push(p))}return o}function an(t){for(var e=-1,n=t?t.length:0,r=n?Ie(Rr(t,"length")):0,i=Fn(r);n>++e;)for(var a=-1,s=t[e];r>++a;)(i[a]||(i[a]=Fn(n)))[e]=s[a];return i}function sn(t){return Ve(t,vr.call(arguments,1))}function on(t){for(var e=-1,n=t?Ie(Rr(arguments,"length")):0,r=Fn(n);n>++e;)r[e]=Rr(arguments,e);return r}function un(t,e){for(var n=-1,r=t?t.length:0,i={};r>++n;){var a=t[n];e?i[a]=e[n]:i[a[0]]=a[1]}return i}function ln(t,e){return 1>t?e():function(){return 1>--t?e.apply(this,arguments):n}}function cn(t,e){return _r.fastBind||or&&arguments.length>2?or.call.apply(or,arguments):B(t,e,vr.call(arguments,2))}function hn(t){for(var e=arguments.length>1?Zn.apply(Kn,vr.call(arguments,1)):ee(t),n=-1,r=e.length;r>++n;){var i=e[n];t[i]=cn(t[i],t)}return t}function fn(t,e){return B(t,e,vr.call(arguments,2),o)}function pn(){var t=arguments;return function(){for(var e=arguments,n=t.length;n--;)e=[t[n].apply(this,e)];return e[0]}}function dn(t,e,r){if(null==t)return Cn;var i=typeof t;if("function"!=i){if("object"!=i)return function(e){return e[t]};var a=Sr(t);return function(e){for(var n=a.length,r=!1;n--&&(r=ue(e[a[n]],t[a[n]],o)););return r}}return e!==n?1===r?function(n){return t.call(e,n)}:2===r?function(n,r){return t.call(e,n,r)}:4===r?function(n,r,i,a){return t.call(e,n,r,i,a)}:function(n,r,i){return t.call(e,n,r,i)}:t}function gn(t,e,n){function r(){a=u=null,l&&(s=t.apply(o,i))}var i,a,s,o,u,l=!0;if(n===!0){var c=!0;l=!1}else n&&H[typeof n]&&(c=n.leading,l="trailing"in n?n.trailing:l);return function(){return i=arguments,o=this,Yn(u),!a&&c?(a=!0,s=t.apply(o,i)):u=ar(r,e),s}}function vn(t){var e=vr.call(arguments,1);return ar(function(){t.apply(n,e)},1)}function mn(t,e){var r=vr.call(arguments,2);return ar(function(){t.apply(n,r)},e)}function yn(t,e){var n={};return function(){var r=u+(e?e.apply(this,arguments):arguments[0]);return nr.call(n,r)?n[r]:n[r]=t.apply(this,arguments)}}function bn(t){var e,n;return function(){return e?n:(e=!0,n=t.apply(this,arguments),t=null,n)}}function _n(t){return B(t,vr.call(arguments,1))}function xn(t){return B(t,vr.call(arguments,1),null,o)}function wn(t,e,n){function r(){o=null,c&&(u=new Un,a=t.apply(s,i))}var i,a,s,o,u=0,l=!0,c=!0;return n===!1?l=!1:n&&H[typeof n]&&(l="leading"in n?n.leading:l,c="trailing"in n?n.trailing:c),function(){var n=new Un;o||l||(u=n);var c=e-(n-u);return i=arguments,s=this,0>=c?(Yn(o),o=null,u=n,a=t.apply(s,i)):o||(o=ar(r,c)),a}}function kn(t,e){return function(){var n=[t];return rr.apply(n,arguments),e.apply(this,n)}}function jn(t){return null==t?"":Dn(t).replace(_,V)}function Cn(t){return t}function En(t){$e(ee(t),function(e){var n=a[e]=t[e];a.prototype[e]=function(){var t=this.__wrapped__,e=[t];rr.apply(e,arguments);var r=n.apply(a,e);return t&&"object"==typeof t&&t==r?this:new J(r)}})}function Sn(){return r._=Xn,this}function On(t,e){return null==t&&null==e&&(e=1),t=+t||0,null==e&&(e=t,t=0),t+tr(gr()*((+e||0)-t+1))}function $n(t,e){var r=t?t[e]:n;return ce(r)?t[e]():r}function Tn(t,e,r){var i=a.templateSettings;t||(t=""),r=xr?Pr({},r,i):i;var s,o=xr&&Pr({},r.imports,i.imports),u=xr?Sr(o):["_"],l=xr?we(o):[a],p=0,g=r.interpolate||b,m="__p += '",y=Vn((r.escape||b).source+"|"+g.source+"|"+(g===v?d:b).source+"|"+(r.evaluate||b).source+"|$","g");t.replace(y,function(e,n,r,i,a,o){return r||(r=i),m+=t.slice(p,o).replace(x,z),n&&(m+="' +\n__e("+n+") +\n'"),a&&(s=!0,m+="';\n"+a+";\n__p += '"),r&&(m+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),p=o+e.length,e}),m+="';\n";var _=r.variable,w=_;w||(_="obj",m="with ("+_+") {\n"+m+"\n}\n"),m=(s?m.replace(c,""):m).replace(h,"$1").replace(f,"$1;"),m="function("+_+") {\n"+(w?"":_+" || ("+_+" = {});\n")+"var __t, __p = '', __e = _.escape"+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+m+"return __p\n}";var k="\n/*\n//@ sourceURL="+(r.sourceURL||"/lodash/template/source["+j++ +"]")+"\n*/";try{var C=qn(u,"return "+m+k).apply(n,l)}catch(E){throw E.source=m,E}return e?C(e):(C.source=m,C)}function An(t,e,n){t=(t=+t)>-1?t:0;var r=-1,i=Fn(t);for(e=a.createCallback(e,n,1);t>++r;)i[r]=e(r);return i}function Pn(t){return null==t?"":Dn(t).replace(p,Q)}function In(t){var e=++s;return Dn(null==t?"":t)+e}function Nn(t,e){return e(t),t}function Hn(){return Dn(this.__wrapped__)}function Rn(){return this.__wrapped__}r=r?F.defaults(t.Object(),r,F.pick(t,w)):t;var Fn=r.Array,Ln=r.Boolean,Un=r.Date,qn=r.Function,Bn=r.Math,Mn=r.Number,zn=r.Object,Vn=r.RegExp,Dn=r.String,Jn=r.TypeError,Kn=Fn(),Wn=zn(),Xn=r._,Qn=Vn("^"+Dn(Wn.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),Gn=Bn.ceil,Yn=r.clearTimeout,Zn=Kn.concat,tr=Bn.floor,er=Qn.test(er=zn.getPrototypeOf)&&er,nr=Wn.hasOwnProperty,rr=Kn.push,ir=r.setImmediate,ar=r.setTimeout,sr=Wn.toString,or=Qn.test(or=sr.bind)&&or,ur=Qn.test(ur=Fn.isArray)&&ur,lr=r.isFinite,cr=r.isNaN,hr=Qn.test(hr=zn.keys)&&hr,fr=Bn.max,pr=Bn.min,dr=r.parseInt,gr=Bn.random,vr=Kn.slice,mr=Qn.test(r.attachEvent),yr=or&&!/\n|true/.test(or+mr),br={};br[E]=Fn,br[S]=Ln,br[O]=Un,br[A]=zn,br[T]=Mn,br[P]=Vn,br[I]=Dn;var _r=a.support={};(function(){var t=function(){this.x=1},e={0:1,length:1},n=[];t.prototype={valueOf:1,y:1};for(var r in new t)n.push(r);for(r in arguments);_r.argsObject=arguments.constructor==zn&&!(arguments instanceof Fn),_r.argsClass=G(arguments),_r.enumPrototypes=t.propertyIsEnumerable("prototype"),_r.fastBind=or&&!yr,_r.ownLast="x"!=n[0],_r.nonEnumArgs=0!=r,_r.nonEnumShadows=!/valueOf/.test(n),_r.spliceObjects=(Kn.splice.call(e,0,1),!e[0]),_r.unindexedChars="xx"!="x"[0]+zn("x")[0];try{_r.nodeClass=!(sr.call(document)==A&&!({toString:0}+""))}catch(i){_r.nodeClass=!0}})(1),a.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:v,variable:"",imports:{_:a}};var xr=Tn("var index, iterable = <%= firstArg %>, result = <%= init %>;\nif (!iterable) return result;\n<%= top %>;\n<% if (arrays) { %>var length = iterable.length; index = -1;\nif (<%= arrays %>) {  <% if (support.unindexedChars) { %>\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  <% } %>\n  while (++index < length) {\n    <%= loop %>\n  }\n}\nelse {  <%  } else if (support.nonEnumArgs) { %>\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      <%= loop %>\n    }\n  } else {  <% } %>  <% if (support.enumPrototypes) { %>\n  var skipProto = typeof iterable == 'function';\n  <% } %>  <% if (useHas && useKeys) { %>\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] ? keys(iterable) : [],\n      length = ownProps.length;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    <% if (support.enumPrototypes) { %>if (!(skipProto && index == 'prototype')) {\n  <% } %>    <%= loop %>\n    <% if (support.enumPrototypes) { %>}\n<% } %>  }  <% } else { %>\n  for (index in iterable) {<%    if (support.enumPrototypes || useHas) { %>\n    if (<%      if (support.enumPrototypes) { %>!(skipProto && index == 'prototype')<% }      if (support.enumPrototypes && useHas) { %> && <% }      if (useHas) { %>hasOwnProperty.call(iterable, index)<% }    %>) {    <% } %>\n    <%= loop %>;    <% if (support.enumPrototypes || useHas) { %>\n    }<% } %>\n  }    <% if (support.nonEnumShadows) { %>\n\n  var ctor = iterable.constructor;\n      <% for (var k = 0; k < 7; k++) { %>\n  index = '<%= shadowedProps[k] %>';\n  if (<%      if (shadowedProps[k] == 'constructor') {        %>!(ctor && ctor.prototype === iterable) && <%      } %>hasOwnProperty.call(iterable, index)) {\n    <%= loop %>\n  }      <% } %>    <% } %>  <% } %>  <% if (arrays || support.nonEnumArgs) { %>\n}<% } %>\n<%= bottom %>;\nreturn result"),wr={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},kr={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : lodash.createCallback(callback, thisArg)",arrays:"typeof length == 'number'",loop:"if (callback(iterable[index], index, collection) === false) return result"},jr={top:"if (!objectTypes[typeof iterable]) return result;\n"+kr.top,arrays:!1};J.prototype=a.prototype,_r.argsClass||(G=function(t){return t?nr.call(t,"callee"):!1});var Cr=ur||function(t){return t?"object"==typeof t&&sr.call(t)==E:!1},Er=M({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)",arrays:!1}),Sr=hr?function(t){return he(t)?_r.enumPrototypes&&"function"==typeof t||_r.nonEnumArgs&&t.length&&G(t)?Er(t):hr(t):[]}:Er,Or=M(kr),$r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Tr=re($r),Ar=M(wr,{top:wr.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = lodash.createCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),Pr=M(wr),Ir=M(kr,jr,{useHas:!1}),Nr=M(kr,jr);ce(/x/)&&(ce=function(t){return"function"==typeof t&&sr.call(t)==$});var Hr=er?function(t){if(!t||sr.call(t)!=A||!_r.argsClass&&G(t))return!1;var e=t.valueOf,n="function"==typeof e&&(n=er(e))&&er(n);return n?t==n||er(t)==n:W(t)}:W,Rr=Pe,Fr=Se;yr&&i&&"function"==typeof ir&&(vn=cn(ir,r));var Lr=8==dr(m+"08")?dr:function(t,e){return dr(ve(t)?t.replace(y,""):t,e||0)};return a.after=ln,a.assign=Ar,a.at=ke,a.bind=cn,a.bindAll=hn,a.bindKey=fn,a.compact=ze,a.compose=pn,a.countBy=Ce,a.createCallback=dn,a.debounce=gn,a.defaults=Pr,a.defer=vn,a.delay=mn,a.difference=Ve,a.filter=Se,a.flatten=Ke,a.forEach=$e,a.forIn=Ir,a.forOwn=Nr,a.functions=ee,a.groupBy=Te,a.initial=Xe,a.intersection=Qe,a.invert=re,a.invoke=Ae,a.keys=Sr,a.map=Pe,a.max=Ie,a.memoize=yn,a.merge=ye,a.min=Ne,a.omit=be,a.once=bn,a.pairs=_e,a.partial=_n,a.partialRight=xn,a.pick=xe,a.pluck=Rr,a.range=Ze,a.reject=Fe,a.rest=tn,a.shuffle=Le,a.sortBy=Be,a.tap=Nn,a.throttle=wn,a.times=An,a.toArray=Me,a.union=nn,a.uniq=rn,a.unzip=an,a.values=we,a.where=Fr,a.without=sn,a.wrap=kn,a.zip=on,a.zipObject=un,a.collect=Pe,a.drop=tn,a.each=$e,a.extend=Ar,a.methods=ee,a.object=un,a.select=Se,a.tail=tn,a.unique=rn,En(a),a.clone=Y,a.cloneDeep=Z,a.contains=je,a.escape=jn,a.every=Ee,a.find=Oe,a.findIndex=De,a.findKey=te,a.has=ne,a.identity=Cn,a.indexOf=We,a.isArguments=G,a.isArray=Cr,a.isBoolean=ie,a.isDate=ae,a.isElement=se,a.isEmpty=oe,a.isEqual=ue,a.isFinite=le,a.isFunction=ce,a.isNaN=fe,a.isNull=pe,a.isNumber=de,a.isObject=he,a.isPlainObject=Hr,a.isRegExp=ge,a.isString=ve,a.isUndefined=me,a.lastIndexOf=Ye,a.mixin=En,a.noConflict=Sn,a.parseInt=Lr,a.random=On,a.reduce=He,a.reduceRight=Re,a.result=$n,a.runInContext=e,a.size=Ue,a.some=qe,a.sortedIndex=en,a.template=Tn,a.unescape=Pn,a.uniqueId=In,a.all=Ee,a.any=qe,a.detect=Oe,a.foldl=He,a.foldr=Re,a.include=je,a.inject=He,Nr(a,function(t,e){a.prototype[e]||(a.prototype[e]=function(){var e=[this.__wrapped__];return rr.apply(e,arguments),t.apply(a,e)})}),a.first=Je,a.last=Ge,a.take=Je,a.head=Je,Nr(a,function(t,e){a.prototype[e]||(a.prototype[e]=function(e,n){var r=t(this.__wrapped__,e,n);return null==e||n&&"function"!=typeof e?r:new J(r)})}),a.VERSION="1.2.1",a.prototype.toString=Hn,a.prototype.value=Rn,a.prototype.valueOf=Rn,Or(["join","pop","shift"],function(t){var e=Kn[t];a.prototype[t]=function(){return e.apply(this.__wrapped__,arguments)}}),Or(["push","reverse","sort","unshift"],function(t){var e=Kn[t];a.prototype[t]=function(){return e.apply(this.__wrapped__,arguments),this}}),Or(["concat","slice","splice"],function(t){var e=Kn[t];a.prototype[t]=function(){return new J(e.apply(this.__wrapped__,arguments))}}),_r.spliceObjects||Or(["pop","shift","splice"],function(t){var e=Kn[t],n="splice"==t;a.prototype[t]=function(){var t=this.__wrapped__,r=e.apply(t,arguments);return 0===t.length&&delete t[0],n?new J(r):r}}),a._each=Or,a._iteratorTemplate=xr,a._shimKeys=Er,a}var n,r="object"==typeof exports&&exports,i="object"==typeof module&&module&&module.exports==r&&module,a="object"==typeof global&&global;(a.global===a||a.window===a)&&(t=a);var s=0,o={},u=+new Date+"",l=200,c=/\b__p \+= '';/g,h=/\b(__p \+=) '' \+/g,f=/(__e\(.*?\)|\b__t\)) \+\n'';/g,p=/&(?:amp|lt|gt|quot|#39);/g,d=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,g=/\w*$/,v=/<%=([\s\S]+?)%>/g,m=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",y=RegExp("^["+m+"]*0+(?=.$)"),b=/($^)/,_=/[&<>"']/g,x=/['\n\r\t\u2028\u2029\\]/g,w=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"],k=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],j=0,C="[object Arguments]",E="[object Array]",S="[object Boolean]",O="[object Date]",$="[object Function]",T="[object Number]",A="[object Object]",P="[object RegExp]",I="[object String]",N={};N[$]=!1,N[C]=N[E]=N[S]=N[O]=N[T]=N[A]=N[P]=N[I]=!0;var H={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},R={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},F=e();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(t._=F,define(function(){return F})):r&&!r.nodeType?i?(i.exports=F)._=F:r._=F:t._=F})(this),function(){var t,e=this,n=e.Backbone,r=[],i=r.push,a=r.slice,s=r.splice;t="undefined"!=typeof exports?exports:e.Backbone={},t.VERSION="1.0.0";var o=e._;o||"undefined"==typeof require||(o=require("underscore")),t.$=e.jQuery||e.Zepto||e.ender||e.$,t.noConflict=function(){return e.Backbone=n,this},t.emulateHTTP=!1,t.emulateJSON=!1;var u=t.Events={on:function(t,e,n){if(!c(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);return r.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,n){if(!c(this,"once",t,[e,n])||!e)return this;var r=this,i=o.once(function(){r.off(t,i),e.apply(this,arguments)});return i._callback=e,this.on(t,i,n)},off:function(t,e,n){var r,i,a,s,u,l,h,f;if(!this._events||!c(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(s=t?[t]:o.keys(this._events),u=0,l=s.length;l>u;u++)if(t=s[u],a=this._events[t]){if(this._events[t]=r=[],e||n)for(h=0,f=a.length;f>h;h++)i=a[h],(e&&e!==i.callback&&e!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=a.call(arguments,1);if(!c(this,"trigger",t,e))return this;var n=this._events[t],r=this._events.all;return n&&h(n,e),r&&h(r,arguments),this},stopListening:function(t,e,n){var r=this._listeners;if(!r)return this;var i=!e&&!n;"object"==typeof e&&(n=this),t&&((r={})[t._listenerId]=t);for(var a in r)r[a].off(e,n,this),i&&delete this._listeners[a];return this}},l=/\s+/,c=function(t,e,n,r){if(!n)return!0;if("object"==typeof n){for(var i in n)t[e].apply(t,[i,n[i]].concat(r));return!1}if(l.test(n)){for(var a=n.split(l),s=0,o=a.length;o>s;s++)t[e].apply(t,[a[s]].concat(r));return!1}return!0},h=function(t,e){var n,r=-1,i=t.length,a=e[0],s=e[1],o=e[2];switch(e.length){case 0:for(;i>++r;)(n=t[r]).callback.call(n.ctx);return;case 1:for(;i>++r;)(n=t[r]).callback.call(n.ctx,a);return;case 2:for(;i>++r;)(n=t[r]).callback.call(n.ctx,a,s);return;case 3:for(;i>++r;)(n=t[r]).callback.call(n.ctx,a,s,o);return;default:for(;i>++r;)(n=t[r]).callback.apply(n.ctx,e)}},f={listenTo:"on",listenToOnce:"once"};o.each(f,function(t,e){u[e]=function(e,n,r){var i=this._listeners||(this._listeners={}),a=e._listenerId||(e._listenerId=o.uniqueId("l"));return i[a]=e,"object"==typeof n&&(r=this),e[t](n,r,this),this}}),u.bind=u.on,u.unbind=u.off,o.extend(t,u);var p=t.Model=function(t,e){var n,r=t||{};e||(e={}),this.cid=o.uniqueId("c"),this.attributes={},o.extend(this,o.pick(e,d)),e.parse&&(r=this.parse(r,e)||{}),(n=o.result(this,"defaults"))&&(r=o.defaults({},r,n)),this.set(r,e),this.changed={},this.initialize.apply(this,arguments)},d=["url","urlRoot","collection"];o.extend(p.prototype,u,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return o.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return o.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var r,i,a,s,u,l,c,h;if(null==t)return this;if("object"==typeof t?(i=t,n=e):(i={})[t]=e,n||(n={}),!this._validate(i,n))return!1;a=n.unset,u=n.silent,s=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=o.clone(this.attributes),this.changed={}),h=this.attributes,c=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)e=i[r],o.isEqual(h[r],e)||s.push(r),o.isEqual(c[r],e)?delete this.changed[r]:this.changed[r]=e,a?delete h[r]:h[r]=e;if(!u){s.length&&(this._pending=!0);for(var f=0,p=s.length;p>f;f++)this.trigger("change:"+s[f],this,h[s[f]],n)}if(l)return this;if(!u)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,o.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,o.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!o.isEmpty(this.changed):o.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?o.clone(this.changed):!1;var e,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var i in t)o.isEqual(r[i],e=t[i])||((n||(n={}))[i]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return o.clone(this._previousAttributes)},fetch:function(t){t=t?o.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,n=t.success;return t.success=function(r){return e.set(e.parse(r,t),t)?(n&&n(e,r,t),e.trigger("sync",e,r,t),void 0):!1},F(this,t),this.sync("read",this,t)},save:function(t,e,n){var r,i,a,s=this.attributes;if(null==t||"object"==typeof t?(r=t,n=e):(r={})[t]=e,!(!r||n&&n.wait||this.set(r,n)))return!1;if(n=o.extend({validate:!0},n),!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=o.extend({},s,r)),void 0===n.parse&&(n.parse=!0);var u=this,l=n.success;return n.success=function(t){u.attributes=s;var e=u.parse(t,n);return n.wait&&(e=o.extend(r||{},e)),o.isObject(e)&&!u.set(e,n)?!1:(l&&l(u,t,n),u.trigger("sync",u,t,n),void 0)},F(this,n),i=this.isNew()?"create":n.patch?"patch":"update","patch"===i&&(n.attrs=r),a=this.sync(i,this,n),r&&n.wait&&(this.attributes=s),a},destroy:function(t){t=t?o.clone(t):{};var e=this,n=t.success,r=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(i){(t.wait||e.isNew())&&r(),n&&n(e,i,t),e.isNew()||e.trigger("sync",e,i,t)},this.isNew())return t.success(),!1;F(this,t);var i=this.sync("delete",this,t);return t.wait||r(),i},url:function(){var t=o.result(this,"urlRoot")||o.result(this.collection,"url")||R();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},o.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=o.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return n?(this.trigger("invalid",this,n,o.extend(e||{},{validationError:n})),!1):!0}});var g=["keys","values","pairs","invert","pick","omit"];o.each(g,function(t){p.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.attributes),o[t].apply(o,e)}});var v=t.Collection=function(t,e){e||(e={}),e.url&&(this.url=e.url),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,o.extend({silent:!0},e))
},m={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};o.extend(v.prototype,u,{model:p,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return t.sync.apply(this,arguments)},add:function(t,e){return this.set(t,o.defaults(e||{},y))},remove:function(t,e){t=o.isArray(t)?t.slice():[t],e||(e={});var n,r,i,a;for(n=0,r=t.length;r>n;n++)a=this.get(t[n]),a&&(delete this._byId[a.id],delete this._byId[a.cid],i=this.indexOf(a),this.models.splice(i,1),this.length--,e.silent||(e.index=i,a.trigger("remove",a,this,e)),this._removeReference(a));return this},set:function(t,e){e=o.defaults(e||{},m),e.parse&&(t=this.parse(t,e)),o.isArray(t)||(t=t?[t]:[]);var n,r,a,u,l,c=e.at,h=this.comparator&&null==c&&e.sort!==!1,f=o.isString(this.comparator)?this.comparator:null,p=[],d=[],g={};for(n=0,r=t.length;r>n;n++)(a=this._prepareModel(t[n],e))&&((u=this.get(a))?(e.remove&&(g[u.cid]=!0),e.merge&&(u.set(a.attributes,e),h&&!l&&u.hasChanged(f)&&(l=!0))):e.add&&(p.push(a),a.on("all",this._onModelEvent,this),this._byId[a.cid]=a,null!=a.id&&(this._byId[a.id]=a)));if(e.remove){for(n=0,r=this.length;r>n;++n)g[(a=this.models[n]).cid]||d.push(a);d.length&&this.remove(d,e)}if(p.length&&(h&&(l=!0),this.length+=p.length,null!=c?s.apply(this.models,[c,0].concat(p)):i.apply(this.models,p)),l&&this.sort({silent:!0}),e.silent)return this;for(n=0,r=p.length;r>n;n++)(a=p[n]).trigger("add",a,this,e);return l&&this.trigger("sort",this,e),this},reset:function(t,e){e||(e={});for(var n=0,r=this.models.length;r>n;n++)this._removeReference(this.models[n]);return e.previousModels=this.models,this._reset(),this.add(t,o.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,o.extend({at:this.length},e)),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,o.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(t,e){return this.models.slice(t,e)},get:function(t){return null==t?void 0:this._byId[null!=t.id?t.id:t.cid||t]},at:function(t){return this.models[t]},where:function(t,e){return o.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw Error("Cannot sort a set without a comparator");return t||(t={}),o.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(o.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},sortedIndex:function(t,e,n){e||(e=this.comparator);var r=o.isFunction(e)?e:function(t){return t.get(e)};return o.sortedIndex(this.models,t,r,n)},pluck:function(t){return o.invoke(this.models,"get",t)},fetch:function(t){t=t?o.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,n=this;return t.success=function(r){var i=t.reset?"reset":"set";n[i](r,t),e&&e(n,r,t),n.trigger("sync",n,r,t)},F(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?o.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var n=this,r=e.success;return e.success=function(i){e.wait&&n.add(t,e),r&&r(t,i,e)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof p)return t.collection||(t.collection=this),t;e||(e={}),e.collection=this;var n=new this.model(t,e);return n._validate(t,e)?n:(this.trigger("invalid",this,t,e),!1)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,r){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,r),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];o.each(b,function(t){v.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.models),o[t].apply(o,e)}});var _=["groupBy","countBy","sortBy"];o.each(_,function(t){v.prototype[t]=function(e,n){var r=o.isFunction(e)?e:function(t){return t.get(e)};return o[t](this.models,r,n)}});var x=t.View=function(t){this.cid=o.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,k=["model","collection","el","id","attributes","className","tagName","events"];o.extend(x.prototype,u,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=o.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var n=t[e];if(o.isFunction(n)||(n=this[t[e]]),n){var r=e.match(w),i=r[1],a=r[2];n=o.bind(n,this),i+=".delegateEvents"+this.cid,""===a?this.$el.on(i,n):this.$el.on(i,a,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(t){this.options&&(t=o.extend({},o.result(this,"options"),t)),o.extend(this,o.pick(t,k)),this.options=t},_ensureElement:function(){if(this.el)this.setElement(o.result(this,"el"),!1);else{var e=o.extend({},o.result(this,"attributes"));this.id&&(e.id=o.result(this,"id")),this.className&&(e["class"]=o.result(this,"className"));var n=t.$("<"+o.result(this,"tagName")+">").attr(e);this.setElement(n,!1)}}}),t.sync=function(e,n,r){var i=j[e];o.defaults(r||(r={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var a={type:i,dataType:"json"};if(r.url||(a.url=o.result(n,"url")||R()),null!=r.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(a.contentType="application/json",a.data=JSON.stringify(r.attrs||n.toJSON(r))),r.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),r.emulateHTTP&&("PUT"===i||"DELETE"===i||"PATCH"===i)){a.type="POST",r.emulateJSON&&(a.data._method=i);var s=r.beforeSend;r.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",i),s?s.apply(this,arguments):void 0}}"GET"===a.type||r.emulateJSON||(a.processData=!1),"PATCH"!==a.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(a.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var u=r.xhr=t.ajax(o.extend(a,r));return n.trigger("request",n,u,r),u};var j={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var C=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},E=/\((.*?)\)/g,S=/(\(\?)?:\w+/g,O=/\*\w+/g,$=/[\-{}\[\]+?.,\\\^$|#\s]/g;o.extend(C.prototype,u,{initialize:function(){},route:function(e,n,r){o.isRegExp(e)||(e=this._routeToRegExp(e)),o.isFunction(n)&&(r=n,n=""),r||(r=this[n]);var i=this;return t.history.route(e,function(a){var s=i._extractParameters(e,a);r&&r.apply(i,s),i.trigger.apply(i,["route:"+n].concat(s)),i.trigger("route",n,s),t.history.trigger("route",i,n,s)}),this},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=o.result(this,"routes");for(var t,e=o.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace($,"\\$&").replace(E,"(?:$1)?").replace(S,function(t,e){return e?t:"([^/]+)"}).replace(O,"(.*?)"),RegExp("^"+t+"$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return o.map(n,function(t){return t?decodeURIComponent(t):null})}});var T=t.History=function(){this.handlers=[],o.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},A=/^[#\/]|\s+$/g,P=/^\/+|\/+$/g,I=/msie [\w.]+/,N=/\/$/;T.started=!1,o.extend(T.prototype,u,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var n=this.root.replace(N,"");t.indexOf(n)||(t=t.substr(n.length))}else t=this.getHash();return t.replace(A,"")},start:function(e){if(T.started)throw Error("Backbone.history has already been started");T.started=!0,this.options=o.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),r=document.documentMode,i=I.exec(navigator.userAgent.toLowerCase())&&(!r||7>=r);this.root=("/"+this.root+"/").replace(P,"/"),i&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(n)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!i?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var a=this.location,s=a.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&s&&a.hash&&(this.fragment=this.getHash().replace(A,""),this.history.replaceState({},document.title,this.root+this.fragment+a.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),T.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash()),void 0)},loadUrl:function(t){var e=this.fragment=this.getFragment(t),n=o.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0});return n},navigate:function(t,e){if(!T.started)return!1;if(e&&e!==!0||(e={trigger:e}),t=this.getFragment(t||""),this.fragment!==t){this.fragment=t;var n=this.root+t;if(this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}e.trigger&&this.loadUrl(t)}},_updateHash:function(t,e,n){if(n){var r=t.href.replace(/(javascript:|#).*$/,"");t.replace(r+"#"+e)}else t.hash="#"+e}}),t.history=new T;var H=function(t,e){var n,r=this;n=t&&o.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},o.extend(n,r,e);var i=function(){this.constructor=n};return i.prototype=r.prototype,n.prototype=new i,t&&o.extend(n.prototype,t),n.__super__=r.prototype,n};p.extend=v.extend=C.extend=x.extend=T.extend=H;var R=function(){throw Error('A "url" property or function must be specified')},F=function(t,e){var n=e.error;e.error=function(r){n&&n(t,r,e),t.trigger("error",t,r,e)}}}.call(this);var ReactionService={getQuestion:function(t,e){var n={question:"What is your reaction?",xTicks:1,yTicks:4,userId:e};return $.Deferred().resolve(n)},getResults:function(){return $.Deferred().resolve([[10,50,20,20]])},postVote:function(){return $.Deferred().resolve(!0)}},Reaction=Backbone.Model.extend({defaults:{xTicks:1,yTicks:1,hasVoted:!1},initialize:function(){this.set("hasVoted",!!this.get("result")),this.set("state",!this.get("result")&&this.get("userId")?"vote":"results")},getMatix:function(){for(var t=[],e=this.get("xTicks"),n=this.get("yTicks"),r=0;e>r;r+=1)t.push(Array(n));return t},vote:function(t,e){!this.get("hasVoted")&&this.get("userId")&&(this.set("result",{x:t,y:e}),this.set("hasVoted",!0),this.set("state","results"))}}),VoteWidget=Backbone.View.extend({events:{"click .reaction":"vote"},initialize:function(){this.listenTo(this.model,"change:state",this.render)},vote:function(t){console.log("VOTE",t);var e=$(t.currentTarget),n=e.data("reaction-x"),r=e.data("reaction-y"),i=this;setTimeout(function(){i.model.vote(n,r)},200)},render:function(){var t='<div class="reaction-question">'+this.model.get("question")+"</div>",e=reaction.getMatix(),n=this.model.get("state"),r=this.model.get("result"),i=this.model.get("userId"),a=this;$.ajax(),"vote"===n?(t+=$.map(e,function(t,e){return'<div class="reaction-axis">'+$.map(t,function(t,n){return'<div class="reaction" data-reaction-x="'+(e+1)+'" data-reaction-y="'+(n+1)+'"></div>'}).join("")+"</div>"}).join(""),this.$el.html(t)):(t+=i?"<p>You voted x: "+r.x+", y: "+r.y+"</p>":"<p>Login to react!</p>",t+="Everyone else's results: ",everyonesResults.done(function(e){t+=_.flatten(e).join(", "),a.$el.html(t)}))}});$(function(){var t="#target1, #target2",e="blahblahblah";ReactionService.getQuestion(e).done(function(e){var n=new Reaction(e);$(t).each(function(){var t=$(this);new VoteWidget({model:n,el:$('<div class="reaction-widget" />').insertAfter(t)[0]}).render()})})});